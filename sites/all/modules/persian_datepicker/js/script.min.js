var kamaDatepicker=function(elementID,opt){if("string"==typeof elementID&&0!==elementID.length){var selectedYear,selectedMonth,todaysYear,todaysMonth,todaysDay,dayOfWeekJ,numberOfDays,todayG,todaysJ,options=opt||{},isCalClicked=!1,isSynced=!1,FA_NUMS=["٠","١","٢","٣","۴","۵","۶","٧","٨","٩","١٠","١١","١٢","١٣","١۴","١۵","١۶","١٧","١٨","١٩","٢٠","٢١","٢٢","٢٣","٢۴","٢۵","٢۶","٢٧","٢٨","٢٩","٣٠","٣١","٣٢"];options.placeholder=void 0!==options.placeholder?options.placeholder:"",options.twodigit=void 0===options.twodigit||options.twodigit,options.closeAfterSelect=void 0===options.closeAfterSelect||options.closeAfterSelect,options.nextButtonIcon=void 0!==options.nextButtonIcon&&options.nextButtonIcon,options.previousButtonIcon=void 0!==options.previousButtonIcon&&options.previousButtonIcon,options.buttonsColor=void 0!==options.buttonsColor&&options.buttonsColor,options.forceFarsiDigits=void 0!==options.forceFarsiDigits&&options.forceFarsiDigits,options.markToday=void 0!==options.markToday&&options.markToday,options.markHolidays=void 0!==options.markHolidays&&options.markHolidays,options.highlightSelectedDay=void 0!==options.highlightSelectedDay&&options.highlightSelectedDay,options.sync=void 0!==options.sync&&options.sync,options.gotoToday=void 0!==options.gotoToday&&options.gotoToday;var inputElement=jQuery("#"+elementID);void 0===inputElement.attr("placeholder")&&inputElement.attr("placeholder",options.placeholder),inputElement.wrap("<div id='bd-root-"+elementID+"' style='position: relative;'></div>"),inputElement.after("<div id='bd-main-"+elementID+"' class='bd-main bd-hide' style='position: absolute; direction: rtl;'></div>");var mainDiv=jQuery("#bd-main-"+elementID);mainDiv.append("<div class='bd-calendar'></div>");var calendarDiv=mainDiv.find(".bd-calendar");calendarDiv.append("<div class='bd-title'></div>");var titleDiv=calendarDiv.find(".bd-title");calendarDiv.append("<table class='bd-table' dir='rtl' cellspacing='0' cellpadding='0'></table>"),titleDiv.append("<button id='bd-next-"+elementID+"' class='bd-next' type='button' title='ماه بعدی' data-toggle='tooltip'><span>بعدی</span></button>");var nextMonth=jQuery("#bd-next-"+elementID);options.nextButtonIcon&&(nextMonth.find("span").css("display","none"),-1!==options.nextButtonIcon.indexOf(".")?nextMonth.css("background-image","url("+options.nextButtonIcon+")"):nextMonth.addClass(options.nextButtonIcon)),titleDiv.append("<div class='bd-dropdown'></div><div class='bd-dropdown'></div>"),titleDiv.find(".bd-dropdown:nth-child(2)").append("<select id='bd-month-"+elementID+"' class='bd-month'></select>");var monthDropdown=jQuery("#bd-month-"+elementID);jQuery.each({1:"فروردین",2:"اردیبهشت",3:"خرداد",4:"تیر",5:"مرداد",6:"شهریور",7:"مهر",8:"آبان",9:"آذر",10:"دی",11:"بهمن",12:"اسفند"},function(key,value){monthDropdown.append(jQuery("<option></option>").attr("value",key).text(value))}),titleDiv.find(".bd-dropdown:nth-child(3)").append("<select id='bd-year-"+elementID+"' class='bd-year'></select>");var yearDropdown=jQuery("#bd-year-"+elementID);titleDiv.append("<button id='bd-prev-"+elementID+"' class='bd-prev' type='button' title='ماه قبلی' data-toggle='tooltip'><span>قبلی</span></button>");var prevMonth=jQuery("#bd-prev-"+elementID);options.nextButtonIcon&&(prevMonth.find("span").css("display","none"),-1!==options.previousButtonIcon.indexOf(".")?prevMonth.css("background-image","url("+options.previousButtonIcon+")"):prevMonth.addClass(options.previousButtonIcon)),options.buttonsColor&&(nextMonth.css("color",options.buttonsColor),nextMonth.find("span").css("color",options.buttonsColor),prevMonth.css("color",options.buttonsColor),prevMonth.find("span").css("color",options.buttonsColor)),calendarDiv.find(".bd-table").append("<thead><tr></tr></thead>"),jQuery.each({"شنبه":"ش","یکشنبه":"ی","دوشنبه":"د","سه شنبه":"س","چهارشنبه":"چ","پنج شنبه":"پ","جمعه":"ج"},function(key,value){calendarDiv.find(".bd-table thead tr").append(jQuery("<th></th>").text(value))}),calendarDiv.find(".bd-table").append("<tbody id='bd-table-days-"+elementID+"' class='bd-table-days'></tbody>");var daysTable=jQuery("#bd-table-days-"+elementID);if(options.gotoToday){calendarDiv.append("<div class='bd-goto-today'>برو به امروز</div>");var gotoToday=calendarDiv.find(".bd-goto-today")}inputElement.on("focus",function(){mainDiv.removeClass("bd-hide"),options.sync&&!1===isSynced&&(syncCalendar(),isSynced=!0)}).on("blur",function(){0==isCalClicked?(mainDiv.addClass("bd-hide"),isSynced=!1):(isCalClicked=!1,inputElement.focus(),event.preventDefault())}),mainDiv.on("mousedown",function(event){isCalClicked=!0}),monthDropdown.on("change",function(){selectedMonth=parseInt(this.value),numberOfDays=monthDays(selectedYear,selectedMonth),dayOfWeekJ=findFirstDayOfMonth(selectedYear,selectedMonth),drawDays(numberOfDays,dayOfWeekJ)}),yearDropdown.on("change",function(){selectedYear=parseInt(this.value),numberOfDays=monthDays(selectedYear,selectedMonth),dayOfWeekJ=findFirstDayOfMonth(selectedYear,selectedMonth),drawDays(numberOfDays,dayOfWeekJ)});var g_days=[31,28,31,30,31,30,31,31,30,31,30,31],j_days=[31,31,31,31,31,31,30,30,30,30,30,29],syncCalendar=function(){var inputValue=fixDate(inputElement.val());""!==inputValue&&(inputValue=inputValue.split("/"),monthDropdown.val(parseInt(inputValue[1])),monthDropdown.trigger("change"),yearDropdown.val(parseInt(inputValue[0])),yearDropdown.trigger("change"),options.highlightSelectedDay&&(mainDiv.find(".bd-selected-day").removeClass("bd-selected-day"),mainDiv.find(".day-"+parseInt(inputValue[2])).addClass("bd-selected-day")))},fixDate=function(date){return""===date?"":((date=date.split("/"))[1].length<2&&date[1]<10&&(date[1]="0"+date[1]),date[2].length<2&&date[2]<10&&(date[2]="0"+date[2]),date=date.join("/"))},monthDays=function(year,month){return month<7?31:month<12?30:function(year){var mod;return year<1343&&year>1243?1==(mod=year%33)||5==mod||9==mod||13==mod||17==mod||22==mod||26==mod||30==mod:year<1473&&year>1342?1==(mod=year%17)||5==mod||9==mod||13==mod||18==mod||22==mod||26==mod||30==mod:"unknown"}(year)?30:29};todaysJ=function(a,r,s){for(var n=(a=parseInt(a))-1600,e=(r=parseInt(r))-1,t=(s=parseInt(s))-1,p=365*n+parseInt((n+3)/4)-parseInt((n+99)/100)+parseInt((n+399)/400),I=0;e>I;++I)p+=g_days[I];e>1&&(n%4==0&&n%100!=0||n%400==0)&&++p;var v=(p+=t)-79,d=parseInt(v/12053);v%=12053;var o=979+33*d+4*parseInt(v/1461);for((v%=1461)>=366&&(o+=parseInt((v-1)/365),v=(v-1)%365),I=0;11>I&&v>=j_days[I];++I)v-=j_days[I];return[o,I+1,v+1]}((todayG=new Date).getFullYear(),todayG.getMonth()+1,todayG.getDate());var selectedDateJ=[];for(i=0;i<3;i++)selectedDateJ[i]=todaysJ[i];todaysYear=todaysJ[0],todaysMonth=todaysJ[1],todaysDay=todaysJ[2],selectedYear=selectedDateJ[0],selectedMonth=selectedDateJ[1],selectedDateJ[2],monthDropdown.val(selectedMonth),function(thisYear){for(yearDropdown.find("option").remove(),i=0;i<101;i++){var tempYear=thisYear-95+i+"";if(options.forceFarsiDigits)for(var j=0;j<10;j++){var rgx=new RegExp(j,"g");tempYear=tempYear.replace(rgx,FA_NUMS[j])}yearDropdown.append(jQuery("<option>",{value:thisYear-95+i,text:tempYear}))}}(selectedYear),yearDropdown.val(selectedYear),numberOfDays=monthDays(selectedYear,selectedMonth);var findFirstDayOfMonth=function(selectedYear,selectedMonth){var firstDayOfMonthG=toGregorian(selectedYear,selectedMonth,1);return firstDayOfMonthG=new Date(firstDayOfMonthG.gy+"/"+firstDayOfMonthG.gm+"/"+firstDayOfMonthG.gd),(dayOfWeekG=firstDayOfMonthG.getDay())<6?dayOfWeekG+1:0;var dayOfWeekG};dayOfWeekJ=findFirstDayOfMonth(selectedYear,selectedMonth);var drawDays=function(numberOfDays,dayOfWeekJ){daysTable.empty();for(var dayIndex=1,rowIndex=1;dayIndex<=numberOfDays;){for(daysTable.append(jQuery("<tr>",{class:"tr-"+rowIndex})),i=0;i<7;i++){if(1==dayIndex)for(var j=0;j<dayOfWeekJ;)jQuery("#bd-table-days-"+elementID+" .tr-1").append(jQuery("<td>",{class:"bd-empty-cell"})),j++,i++;if(i<7&&dayIndex<=numberOfDays){var tempTD='<td><button class="day day-'+dayIndex+'" type="button">'+(options.forceFarsiDigits?FA_NUMS[dayIndex]:dayIndex)+"</button></td>";if(options.markToday&&dayIndex==todaysDay&&todaysMonth==selectedMonth&&todaysYear==selectedYear){var idx=tempTD.indexOf("day day-");tempTD=tempTD.slice(0,idx)+" bd-today "+tempTD.slice(idx)}if(options.markHolidays&&6==i){idx=tempTD.indexOf("day day-");tempTD=tempTD.slice(0,idx)+" bd-holiday "+tempTD.slice(idx)}jQuery("#bd-table-days-"+elementID+" .tr-"+rowIndex).append(tempTD),dayIndex++}}rowIndex++}if(options.highlightSelectedDay){var inputValue=inputElement.val();(inputValue=inputValue.split("/"))[0]==selectedYear&&inputValue[1]==selectedMonth&&(mainDiv.find(".bd-selected-day").removeClass("bd-selected-day"),mainDiv.find(".day-"+parseInt(inputValue[2])).addClass("bd-selected-day"))}};inputElement.parent().on("click","button.day",function(){var datestr=selectedYear+"/"+selectedMonth+"/"+jQuery(this).attr("class").split(" ")[jQuery(this).attr("class").split(" ").indexOf("day")+1].split("-")[1];options.twodigit&&(datestr=fixDate(datestr)),inputElement.val(datestr),inputElement.trigger("change"),options.closeAfterSelect&&(isCalClicked=!1,inputElement.trigger("blur")),options.highlightSelectedDay&&(mainDiv.find(".bd-selected-day").removeClass("bd-selected-day"),jQuery(this).addClass("bd-selected-day"))}),nextMonth.on("click",function(){monthDropdown.val()<12?(monthDropdown.val(parseInt(monthDropdown.val())+1),monthDropdown.trigger("change")):(monthDropdown.val(1),monthDropdown.trigger("change"),yearDropdown.val(parseInt(yearDropdown.val())+1),yearDropdown.trigger("change"))}),prevMonth.on("click",function(){monthDropdown.val()>1?(monthDropdown.val(parseInt(monthDropdown.val())-1),monthDropdown.trigger("change")):(monthDropdown.val(12),monthDropdown.trigger("change"),yearDropdown.val(parseInt(yearDropdown.val())-1),yearDropdown.trigger("change"))}),options.gotoToday&&gotoToday.on("click",function(){monthDropdown.val(todaysMonth),monthDropdown.trigger("change"),yearDropdown.val(todaysYear),yearDropdown.trigger("change")}),drawDays(numberOfDays,dayOfWeekJ),"function"==typeof jQuery().modal&&jQuery('[data-toggle="tooltip"]').tooltip()}else console.error("kamadatepicker error: input ID is not string or is empty");function toGregorian(d,i,a){return d2g(function(d,i,a){var n=jalCal(d);return g2d(n.gy,3,n.march)+31*(i-1)-div(i,7)*(i-7)+a-1}(d,i,a))}function jalCal(d){var i,a,n,t,o,v,e=[-61,9,38,199,426,686,756,818,1111,1181,1210,1635,2060,2097,2192,2262,2324,2394,2456,3178],l=e.length,u=d+621,m=-14,g=e[0];if(g>d||d>=e[l-1])throw new Error("Invalid Jalaali year "+d);for(v=1;l>v&&(i=e[v],a=i-g,!(i>d));v+=1)m=m+8*div(a,33)+div(mod(a,33),4),g=i;return m=m+8*div(o=d-g,33)+div(mod(o,33)+3,4),4===mod(a,33)&&a-o==4&&(m+=1),t=20+m-(div(u,4)-div(3*(div(u,100)+1),4)-150),6>a-o&&(o=o-a+33*div(a+4,33)),-1===(n=mod(mod(o+1,33)-1,4))&&(n=4),{leap:n,gy:u,march:t}}function g2d(d,i,a){var n=div(1461*(d+div(i-8,6)+100100),4)+div(153*mod(i+9,12)+2,5)+a-34840408;return n-div(3*div(d+100100+div(i-8,6),100),4)+752}function d2g(d){var i,a,n,r;return n=div(mod(a=5*div(mod(i=(i=4*d+139361631)+4*div(3*div(4*d+183187720,146097),4)-3908,1461),4)+308,153),5)+1,r=mod(div(a,153),12)+1,{gy:div(i,1461)-100100+div(8-r,6),gm:r,gd:n}}function div(d,i){return~~(d/i)}function mod(d,i){return d-~~(d/i)*i}};jQuery(document).ready(function(){kamaDatepicker("date-picker",{buttonsColor:"red",forceFarsiDigits:!0})});